<!DOCTYPE html>
<html>
<head>
<title>Relatorio_Incidente_Ransomware_FS_Profissional.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="relat%C3%B3rio-de-incidente-de-seguran%C3%A7a-cibern%C3%A9tica">RELAT√ìRIO DE INCIDENTE DE SEGURAN√áA CIBERN√âTICA</h1>
<h2 id="an%C3%A1lise-forense-de-ransomware---servidor-fs">An√°lise Forense de Ransomware - Servidor FS</h2>
<h1 id="lab---%F0%9F%9A%A8-socal3rt-%F0%9F%9A%A8">LAB - üö® SOC_AL3RT üö® -</h1>
<hr>
<p><strong>DOCUMENTO CONFIDENCIAL</strong><br>
<strong>Classifica√ß√£o:</strong> RESTRITO<br>
<strong>N√∫mero do Caso:</strong> INC-FS-2025-001<br>
<strong>Data do Incidente:</strong> 27/09/2025<br>
<strong>Data do Relat√≥rio:</strong> 27/09/2025<br>
<strong>Laborat√≥rio:</strong> SOC_AL3RT</p>
<hr>
<h2 id="sum%C3%A1rio-executivo">SUM√ÅRIO EXECUTIVO</h2>
<h3 id="resumo-do-incidente">Resumo do Incidente</h3>
<p>O presente relat√≥rio documenta a investiga√ß√£o forense realizada em um servidor Windows Server 2019 (hostname: FS) que foi comprometido por ransomware identificado como <strong>Ransomware.Python/NCSLM</strong>. A an√°lise revelou m√∫ltiplos vetores de ataque, mecanismos de persist√™ncia sofisticados e tentativas de mascaramento atrav√©s de nomes de processos leg√≠timos do Windows.</p>
<h3 id="impacto-identificado">Impacto Identificado</h3>
<ul>
<li><strong>Criticidade:</strong> ALTA</li>
<li><strong>Sistema Afetado:</strong> Windows Server 2019 Standard (Build 17763)</li>
<li><strong>Tipo de Malware:</strong> Ransomware Python-based</li>
<li><strong>Artefatos Maliciosos:</strong> 3 localiza√ß√µes confirmadas</li>
<li><strong>Mecanismos de Persist√™ncia:</strong> 4 vetores identificados</li>
</ul>
<hr>
<h2 id="1-informa%C3%A7%C3%B5es-do-ativo-comprometido">1. INFORMA√á√ïES DO ATIVO COMPROMETIDO</h2>
<h3 id="11-especifica%C3%A7%C3%B5es-t%C3%A9cnicas-detalhadas">1.1 Especifica√ß√µes T√©cnicas Detalhadas</h3>
<ul>
<li><strong>Hostname:</strong> FS</li>
<li><strong>Sistema Operacional:</strong> Microsoft Windows Server 2019 Standard</li>
<li><strong>Build:</strong> 10.0.17763 (17763)</li>
<li><strong>Arquitetura:</strong> 64-bit</li>
<li><strong>Processador:</strong> Virtualizado (QEMU) - Detalhes n√£o dispon√≠veis via WMI</li>
<li><strong>Mem√≥ria RAM:</strong> 7.81 GB (Banco √∫nico, Tipo 9)</li>
<li><strong>Armazenamento Principal:</strong> 25.00 GB (QEMU QEMU HARDDISK SCSI Disk Device)</li>
<li><strong>Volumes Identificados:</strong>
<ul>
<li><strong>Sistema:</strong> 0.34 GB (0.31 GB livre)</li>
<li><strong>C:\ (Windows):</strong> 24.66 GB (0.00 GB livre)</li>
</ul>
</li>
<li><strong>IP:</strong> 10.0.3.152</li>
<li><strong>MAC:</strong> FA-16-3E-4F-48-AF</li>
<li><strong>BIOS:</strong> SeaBIOS v1.16.3-debian-1.16.3-2~bpo12+1 (31/03/2014)</li>
</ul>
<h3 id="12-ambiente-de-rede-e-seguran%C3%A7a">1.2 Ambiente de Rede e Seguran√ßa</h3>
<ul>
<li><strong>Gateway:</strong> 10.0.0.3</li>
<li><strong>DNS:</strong> 8.8.8.8</li>
<li><strong>Interface:</strong> Ethernet 3 (Red Hat VirtIO Ethernet Adapter #3)</li>
<li><strong>Velocidade de Rede:</strong> 10 Gbps</li>
<li><strong>Tipo de Conex√£o:</strong> VPN (ExtremeVPN)</li>
<li><strong>Firewall Status:</strong>
<ul>
<li>Domain:  Enabled</li>
<li>Private:  Enabled</li>
<li>Public:  Enabled</li>
</ul>
</li>
<li><strong>Antiv√≠rus:</strong>  <strong>NENHUM DETECTADO</strong></li>
</ul>
<h3 id="13-%C3%BAltimas-atualiza%C3%A7%C3%B5es-de-seguran%C3%A7a">1.3 √öltimas Atualiza√ß√µes de Seguran√ßa</h3>
<ul>
<li><strong>KB5022840</strong> - 17/02/2023</li>
<li><strong>KB5020374</strong> - 17/02/2023</li>
<li><strong>KB5012170</strong> - 17/02/2023</li>
<li><strong>KB5022511</strong> - 17/02/2023</li>
<li><strong>KB4589208</strong> - 17/02/2023</li>
</ul>
<p><strong>OBSERVA√á√ÉO CR√çTICA:</strong> √öltima atualiza√ß√£o em fevereiro de 2023 - sistema desatualizado h√° mais de 2 anos.</p>
<hr>
<h2 id="2-metodologia-de-investiga%C3%A7%C3%A3o">2. METODOLOGIA DE INVESTIGA√á√ÉO</h2>
<h3 id="21-equipamentos-utilizados">2.1 Equipamentos Utilizados</h3>
<ul>
<li><strong>Esta√ß√£o de An√°lise:</strong> Kali Linux 6.12.38 (VM isolada)</li>
<li><strong>Configura√ß√£o VM:</strong> 40GB HD, 5GB RAM, Rede NAT</li>
<li><strong>Ferramentas Forenses:</strong>
<ul>
<li>Autoruns64.exe (Microsoft Sysinternals)</li>
<li>Disk2VHD64 (Microsoft)</li>
<li>PowerShell Scripts Customizados</li>
<li>VirusTotal (verifica√ß√£o de hashes)</li>
</ul>
</li>
</ul>
<h3 id="22-protocolo-de-conex%C3%A3o-segura">2.2 Protocolo de Conex√£o Segura</h3>
<ul>
<li><strong>Conex√£o:</strong> OpenVPN + RDP</li>
<li><strong>Criptografia:</strong> ExtremVPN + RDP criptografado</li>
<li><strong>Auditoria:</strong> Controle 270920250907 (2 backups criptografados)</li>
<li><strong>Isolamento:</strong> VM sem acesso √† rede de produ√ß√£o</li>
</ul>
<hr>
<h2 id="3-artefatos-maliciosos-identificados">3. ARTEFATOS MALICIOSOS IDENTIFICADOS</h2>
<h3 id="31-arquivos-maliciosos-encontrados">3.1 Arquivos Maliciosos Encontrados</h3>
<table>
<thead>
<tr>
<th>Localiza√ß√£o</th>
<th>Nome do Arquivo</th>
<th>Tamanho</th>
<th>Hash SHA256</th>
<th>Status Assinatura</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C:\Users\Administrator\AppData\Roaming\OneDrive.exe</code></td>
<td>OneDrive.exe</td>
<td>19.293.482 bytes</td>
<td>1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F</td>
<td>N√£o Assinado</td>
</tr>
<tr>
<td><code>C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe</code></td>
<td>svchost.exe</td>
<td>19.293.482 bytes</td>
<td>1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F</td>
<td>N√£o Assinado</td>
</tr>
<tr>
<td><code>C:\Windows\Temp\OneDrive.exe</code></td>
<td>OneDrive.exe</td>
<td>19.293.482 bytes</td>
<td>1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F</td>
<td>N√£o Assinado</td>
</tr>
</tbody>
</table>
<h3 id="32-verifica%C3%A7%C3%A3o-de-integridade">3.2 Verifica√ß√£o de Integridade</h3>
<ul>
<li><strong>Hash MD5:</strong> 77C59720BC328CF9D692A215AA2575AD</li>
<li><strong>Hash SHA1:</strong> EF1A74599739AB0F91D9CE44C4F4A86B24563E4F</li>
<li><strong>Hash SHA256:</strong> 1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F</li>
<li><strong>VirusTotal:</strong> <a href="https://www.virustotal.com/gui/file/1cb281692409b000c6bfd17c737ce96ec98dec9a5d420eeb6e5b0c131fc2bd5f">Link de Verifica√ß√£o</a></li>
<li><strong>Classifica√ß√£o:</strong> Ransomware.Python/NCSLM</li>
</ul>
<hr>
<h2 id="4-mecanismos-de-persist%C3%AAncia-identificados">4. MECANISMOS DE PERSIST√äNCIA IDENTIFICADOS</h2>
<h3 id="41-registro-do-windows-registry">4.1 Registro do Windows (Registry)</h3>
<h4 id="hkeycurrentusersoftwaremicrosoftwindowscurrentversionrun">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</h4>
<pre class="hljs"><code><div>Value Name: Windows Update
Value Data: C:\Users\Administrator\AppData\Roaming\OneDrive.exe
</div></code></pre>
<h4 id="hkeylocalmachinesystemcurrentcontrolsetcontrolsession-managerupdate">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Update</h4>
<pre class="hljs"><code><div>Value Name: Update
Value Data: C:\Windows\Temp\OneDrive.exe
</div></code></pre>
<h3 id="42-tarefas-agendadas-scheduled-tasks">4.2 Tarefas Agendadas (Scheduled Tasks)</h3>
<h4 id="tarefa-microsoftwindowssqm-update">Tarefa: \Microsoft\Windows\Sqm-Update</h4>
<ul>
<li><strong>Trigger:</strong> BootTrigger (execu√ß√£o na inicializa√ß√£o)</li>
<li><strong>Comando:</strong> <code>C:\Windows\Temp\OneDrive.exe</code></li>
<li><strong>Usu√°rio:</strong> S-1-5-21-2066253582-1997001687-2883272801-500 (Administrator)</li>
</ul>
<h4 id="tarefa-microsoftwindowswindows-update">Tarefa: \Microsoft\Windows\Windows Update</h4>
<ul>
<li><strong>Trigger:</strong> BootTrigger (execu√ß√£o na inicializa√ß√£o)</li>
<li><strong>Comando:</strong> <code>C:\Windows\Temp\OneDrive.exe</code></li>
<li><strong>Usu√°rio:</strong> S-1-5-21-2066253582-1997001687-2883272801-500 (Administrator)</li>
</ul>
<h3 id="43-pasta-de-inicializa%C3%A7%C3%A3o">4.3 Pasta de Inicializa√ß√£o</h3>
<ul>
<li><strong>Localiza√ß√£o:</strong> <code>C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe</code></li>
<li><strong>M√©todo:</strong> Execu√ß√£o autom√°tica no login do usu√°rio</li>
</ul>
<hr>
<h2 id="5-an%C3%A1lise-comparativa-com-arquivos-leg%C3%ADtimos">5. AN√ÅLISE COMPARATIVA COM ARQUIVOS LEG√çTIMOS</h2>
<h3 id="51-svchostexe-leg%C3%ADtimo">5.1 svchost.exe Leg√≠timo</h3>
<table>
<thead>
<tr>
<th>Atributo</th>
<th>Valor Leg√≠timo</th>
<th>Valor Malicioso</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Localiza√ß√£o</strong></td>
<td><code>C:\Windows\SysWOW64\svchost.exe</code>, <code>C:\Windows\System32\svchost.exe</code></td>
<td><code>C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe</code></td>
</tr>
<tr>
<td><strong>Tamanho</strong></td>
<td>45.488 bytes</td>
<td>19.293.482 bytes</td>
</tr>
<tr>
<td><strong>Data Modifica√ß√£o</strong></td>
<td>17/02/2023 12:18:42 PM</td>
<td>14/11/2023 9:20:16 PM</td>
</tr>
<tr>
<td><strong>Hash MD5</strong></td>
<td>D9E224ACFFD36B1C83E8EE2031CCF349</td>
<td>77C59720BC328CF9D692A215AA2575AD</td>
</tr>
</tbody>
</table>
<h3 id="52-onedriveexe-leg%C3%ADtimo">5.2 OneDrive.exe Leg√≠timo</h3>
<p><strong>Localiza√ß√µes Leg√≠timas:</strong>
Esses seria os caminhos legitimos de intala√ß√£o de uma ferramenta OneDrive</p>
<ul>
<li><code>C:\Users\&lt;usu√°rio&gt;\AppData\Local\Microsoft\OneDrive\OneDrive.exe</code></li>
<li><code>C:\Program Files\Microsoft OneDrive\OneDrive.exe</code></li>
<li><code>C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe</code></li>
</ul>
<blockquote>
<p>[!obs] Informa√ß√µes<br>
** Windows Server 2019 e anteriores N√£o traz necessariamente o cliente OneDrive pr√©-ativado** como em desktops; qualquer <code>OneDrive.exe</code> encontrado nesses caminhos (ex.: <code>C:\Temp</code>, <code>C:\Users\Public</code>, etc.) deve ser investigado. Fonte:https://learn.microsoft.com/en-us/sharepoint/per-machine-installation?utm_source=chatgpt.com</p>
</blockquote>
<p><strong>Localiza√ß√£o Maliciosa Identificada:</strong></p>
<ul>
<li><code>C:\Users\Administrator\AppData\Roaming\OneDrive.exe</code></li>
</ul>
<hr>
<h2 id="6-evid%C3%AAncias-fotogr%C3%A1ficas">6. EVID√äNCIAS FOTOGR√ÅFICAS</h2>
<h3 id="61-resumo-das-evid%C3%AAncias-coletadas">6.1 Resumo das Evid√™ncias Coletadas</h3>
<p><strong>Total de evid√™ncias fotogr√°ficas:</strong> 14 imagens documentadas</p>
<h4 id="611-artefatos-maliciosos-identificados">6.1.1 Artefatos Maliciosos Identificados</h4>
<ul>
<li><strong>Autoruns IOC:</strong> <code>Img/Autorun-ferramenta_IOC.png</code> - Processos n√£o assinados detectados</li>
<li><strong>OneDrive Malicioso:</strong> <code>Img/roaming_OneDrive.png</code> - Arquivo em localiza√ß√£o n√£o padr√£o</li>
<li><strong>svchost Malicioso:</strong> <code>Img/svchost_startup.png</code> - Processo na pasta de startup</li>
<li><strong>Script Custom:</strong> <code>Img/ScriptCustom_FInd_onedrive_svchost.png</code> - Ferramenta de identifica√ß√£o</li>
</ul>
<h4 id="612-mecanismos-de-persist%C3%AAncia">6.1.2 Mecanismos de Persist√™ncia</h4>
<ul>
<li><strong>Tarefa Windows Update:</strong> <code>Img/Taref_windows_update.png</code> - Tarefa maliciosa disfar√ßada</li>
<li><strong>Tarefa Sqm-Update:</strong> <code>Img/Tarefa_Sqm_update.png</code> - Tarefa maliciosa adicional</li>
<li><strong>Persist√™ncia Registry:</strong> <code>Img/persistenciaHkey.png</code> - Entradas maliciosas no registro</li>
<li><strong>Persist√™ncia Tarefas:</strong> <code>Img/persistencia_tarefas.png</code> - Vis√£o geral das tarefas (desativadas para evitar persist√™ncia)</li>
</ul>
<h4 id="613-processos-e-mitiga%C3%A7%C3%A3o">6.1.3 Processos e Mitiga√ß√£o</h4>
<ul>
<li><strong>Processos Ativos:</strong> <code>Img/processo.png</code> - Processos em execu√ß√£o no momento da an√°lise</li>
<li><strong>PIDs Identificados:</strong> <code>Img/processos_pid.png</code> - Identifica√ß√£o de processos espec√≠ficos</li>
<li><strong>OneDrive Persistente:</strong> <code>Img/ProcessoOneDrive_Percistente.png</code> - Processo malicioso ativo</li>
<li><strong>Termina√ß√£o de Processo:</strong> <code>Img/Matando_processo_malicioso.png</code> - A√ß√£o de mitiga√ß√£o executada</li>
<li><strong>Configura√ß√£o Disk2VHD:</strong> <code>Img/Configuracao_ferramenta_disk2vhd.png</code> - Prepara√ß√£o para c√≥pia forense</li>
<li><strong>C√≥pia VHDX:</strong> <code>Img/envio_de_copia_FS_VHDX.png</code> - Preserva√ß√£o de evid√™ncias para an√°lise segura</li>
</ul>
<p><strong>Nota:</strong> Todas as evid√™ncias est√£o detalhadamente apresentadas na sequ√™ncia de identifica√ß√£o da Se√ß√£o 7, onde cada imagem √© contextualizada no processo de investiga√ß√£o.</p>
<hr>
<h2 id="7-forma-de-opera%C3%A7%C3%A3o-do-ataque-ttps">7. FORMA DE OPERA√á√ÉO DO ATAQUE (TTPs)</h2>
<h3 id="71-sequ%C3%AAncia-de-identifica%C3%A7%C3%A3o-e-an%C3%A1lise">7.1 Sequ√™ncia de Identifica√ß√£o e An√°lise</h3>
<h4 id="fase-1-reconhecimento-inicial"><strong>FASE 1: Reconhecimento Inicial</strong></h4>
<p>Ap√≥s estabelecer conex√£o segura via VPN e RDP, foi executado script customizado para invent√°rio completo do ativo:</p>
<p><strong>Objetivo:</strong> Coletar informa√ß√µes b√°sicas do sistema para entender o ambiente comprometido.</p>
<h4 id="fase-2-an%C3%A1lise-de-processos-em-execu%C3%A7%C3%A3o"><strong>FASE 2: An√°lise de Processos em Execu√ß√£o</strong></h4>
<p>Identifica√ß√£o de processos suspeitos atrav√©s do Gerenciador de Tarefas (rocexp64.exe):</p>
<p><img src="Img/processo.png" alt="Processos em Execu√ß√£o"></p>
<p>Valida√ß√£o da assinaturas e coleta de hash para analise no virus total, com script custom:</p>
<p><img src="Img/ScriptCustom_FInd_onedrive_svchost.png" alt="Script Custom de Invent√°rio"></p>
<p>Retorno da ferramenta:</p>
<p><code>&quot;Path&quot;,&quot;Name&quot;,&quot;SizeBytes&quot;,&quot;LastWriteUtc&quot;,&quot;SignatureStatus&quot;,&quot;Signer&quot;,&quot;SignerThumb&quot;,&quot;TimeStamp&quot;,&quot;MD5&quot;,&quot;SHA1&quot;,&quot;SHA256&quot;&quot;C:\Users\Administrator\AppData\Roaming\OneDrive.exe&quot;,&quot;OneDrive.exe&quot;,&quot;19293482&quot;,&quot;11/14/2023 9:19:59 PM&quot;,&quot;NotSigned&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;77C59720BC328CF9D692A215AA2575AD&quot;,&quot;EF1A74599739AB0F91D9CE44C4F4A86B24563E4F&quot;,&quot;1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F&quot;&quot;C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe&quot;,&quot;svchost.exe&quot;,&quot;19293482&quot;,&quot;11/14/2023 9:20:16 PM&quot;,&quot;NotSigned&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;77C59720BC328CF9D692A215AA2575AD&quot;,&quot;EF1A74599739AB0F91D9CE44C4F4A86B24563E4F&quot;,&quot;1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F&quot;</code></p>
<p><strong>Descoberta:</strong> Processos OneDrive.exe e svchost.exe em execu√ß√£o com comportamento an√¥malo.</p>
<h4 id="fase-3-an%C3%A1lise-com-autoruns64exe"><strong>FASE 3: An√°lise com Autoruns64.exe</strong></h4>
<p>Utiliza√ß√£o de ferramenta especializada para identificar processos de inicializa√ß√£o:</p>
<p><img src="Img/Autorun-ferramenta_IOC.png" alt="Autoruns IOC - Processos N√£o Assinados"></p>
<p><strong>Descoberta Cr√≠tica:</strong></p>
<ul>
<li>OneDrive.exe sem assinatura digital em <code>C:\Users\Administrator\AppData\Roaming\OneDrive.exe</code></li>
<li>svchost.exe malicioso em <code>C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe</code></li>
</ul>
<h4 id="fase-4-verifica%C3%A7%C3%A3o-de-arquivos-maliciosos"><strong>FASE 4: Verifica√ß√£o de Arquivos Maliciosos</strong></h4>
<p>Confirma√ß√£o visual dos arquivos maliciosos em suas localiza√ß√µes:</p>
<p><img src="Img/roaming_OneDrive.png" alt="OneDrive Malicioso em Roaming"></p>
<p><img src="Img/svchost_startup.png" alt="svchost Malicioso na Pasta de Startup"></p>
<p><strong>Confirma√ß√£o:</strong> Mesmos arquivos identificados pelo Autoruns em localiza√ß√µes n√£o padr√£o.</p>
<h4 id="fase-5-an%C3%A1lise-de-persist%C3%AAncia---registry"><strong>FASE 5: An√°lise de Persist√™ncia - Registry</strong></h4>
<p>Identifica√ß√£o de mecanismos de persist√™ncia no registro do Windows:</p>
<p><img src="Img/persistenciaHkey.png" alt="Persist√™ncia Registry"></p>
<p><strong>Descoberta:</strong> Entrada maliciosa &quot;Windows Update&quot; apontando para OneDrive.exe falso.</p>
<h4 id="fase-6-an%C3%A1lise-de-persist%C3%AAncia---tarefas-agendadas"><strong>FASE 6: An√°lise de Persist√™ncia - Tarefas Agendadas</strong></h4>
<p>Identifica√ß√£o de tarefas maliciosas disfar√ßadas:</p>
<p><img src="Img/Taref_windows_update.png" alt="Tarefa Windows Update Maliciosa"></p>
<p><img src="Img/Tarefa_Sqm_update.png" alt="Tarefa Sqm-Update Maliciosa"></p>
<p><strong>Descoberta:</strong> Duas tarefas agendadas executando malware na inicializa√ß√£o do sistema.</p>
<h4 id="fase-7-an%C3%A1lise-de-persist%C3%AAncia---vis%C3%A3o-geral"><strong>FASE 7: An√°lise de Persist√™ncia - Vis√£o Geral</strong></h4>
<p>Resumo dos mecanismos de persist√™ncia identificados:</p>
<p><img src="Img/persistencia_tarefas.png" alt="Persist√™ncia Tarefas"></p>
<p><strong>Comandos utilizados para extrair informa√ß√µes das tarefas:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Extrair detalhes da tarefa Sqm-Update</span>
schtasks /Query /TN <span class="hljs-string">"\Microsoft\Windows\Sqm-Update"</span> /XML

<span class="hljs-comment"># Extrair detalhes da tarefa Windows Update</span>
schtasks /Query /TN <span class="hljs-string">"\Microsoft\Windows\Windows Update"</span> /XML
</div></code></pre>
<p><strong>XML da tarefa Sqm-Update:</strong></p>
<pre class="hljs"><code><div><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-16"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Task</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.2"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/windows/2004/02/mit/task"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RegistrationInfo</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">URI</span>&gt;</span>\Microsoft\Windows\Sqm-Update<span class="hljs-tag">&lt;/<span class="hljs-name">URI</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RegistrationInfo</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Principals</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Principal</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Author"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">UserId</span>&gt;</span>S-1-5-21-2066253582-1997001687-2883272801-500<span class="hljs-tag">&lt;/<span class="hljs-name">UserId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LogonType</span>&gt;</span>InteractiveToken<span class="hljs-tag">&lt;/<span class="hljs-name">LogonType</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Principal</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Principals</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Settings</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">DisallowStartIfOnBatteries</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">DisallowStartIfOnBatteries</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">StopIfGoingOnBatteries</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">StopIfGoingOnBatteries</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MultipleInstancesPolicy</span>&gt;</span>IgnoreNew<span class="hljs-tag">&lt;/<span class="hljs-name">MultipleInstancesPolicy</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">IdleSettings</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Duration</span>&gt;</span>PT10M<span class="hljs-tag">&lt;/<span class="hljs-name">Duration</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">WaitTimeout</span>&gt;</span>PT1H<span class="hljs-tag">&lt;/<span class="hljs-name">WaitTimeout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">StopOnIdleEnd</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">StopOnIdleEnd</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">RestartOnIdle</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">RestartOnIdle</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">IdleSettings</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Settings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Triggers</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">BootTrigger</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Triggers</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Actions</span> <span class="hljs-attr">Context</span>=<span class="hljs-string">"Author"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Exec</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Command</span>&gt;</span>C:\Windows\Temp\OneDrive.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Command</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Exec</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Actions</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Task</span>&gt;</span>
</div></code></pre>
<p><strong>XML da tarefa Windows Update:</strong></p>
<pre class="hljs"><code><div><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-16"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Task</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.2"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/windows/2004/02/mit/task"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RegistrationInfo</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">URI</span>&gt;</span>\Microsoft\Windows\Windows Update<span class="hljs-tag">&lt;/<span class="hljs-name">URI</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RegistrationInfo</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Principals</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Principal</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Author"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">UserId</span>&gt;</span>S-1-5-21-2066253582-1997001687-2883272801-500<span class="hljs-tag">&lt;/<span class="hljs-name">UserId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LogonType</span>&gt;</span>InteractiveToken<span class="hljs-tag">&lt;/<span class="hljs-name">LogonType</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Principal</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Principals</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Settings</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">DisallowStartIfOnBatteries</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">DisallowStartIfOnBatteries</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">StopIfGoingOnBatteries</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">StopIfGoingOnBatteries</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MultipleInstancesPolicy</span>&gt;</span>IgnoreNew<span class="hljs-tag">&lt;/<span class="hljs-name">MultipleInstancesPolicy</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">IdleSettings</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Duration</span>&gt;</span>PT10M<span class="hljs-tag">&lt;/<span class="hljs-name">Duration</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">WaitTimeout</span>&gt;</span>PT1H<span class="hljs-tag">&lt;/<span class="hljs-name">WaitTimeout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">StopOnIdleEnd</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">StopOnIdleEnd</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">RestartOnIdle</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">RestartOnIdle</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">IdleSettings</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Settings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Triggers</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">BootTrigger</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Triggers</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Actions</span> <span class="hljs-attr">Context</span>=<span class="hljs-string">"Author"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Exec</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Command</span>&gt;</span>C:\Windows\Temp\OneDrive.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Command</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Exec</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Actions</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Task</span>&gt;</span>
</div></code></pre>
<p><strong>Confirma√ß√£o:</strong> M√∫ltiplos vetores de persist√™ncia ativos.</p>
<h4 id="fase-8-an%C3%A1lise-de-processos-ativos"><strong>FASE 8: An√°lise de Processos Ativos</strong></h4>
<p>Identifica√ß√£o de PIDs e processos em execu√ß√£o:</p>
<p><img src="Img/processos_pid.png" alt="PIDs Processos"></p>
<p><strong>Descoberta:</strong> Processos maliciosos ativos com PIDs espec√≠ficos.</p>
<h4 id="fase-9-confirma%C3%A7%C3%A3o-de-persist%C3%AAncia-ativa"><strong>FASE 9: Confirma√ß√£o de Persist√™ncia Ativa</strong></h4>
<p>Verifica√ß√£o de processo OneDrive persistente em execu√ß√£o:</p>
<p><img src="Img/ProcessoOneDrive_Percistente.png" alt="OneDrive Persistente"></p>
<p><strong>Confirma√ß√£o:</strong> Malware ativo e executando.</p>
<h4 id="fase-10-mitiga%C3%A7%C3%A3o---termina%C3%A7%C3%A3o-de-processo"><strong>FASE 10: Mitiga√ß√£o - Termina√ß√£o de Processo</strong></h4>
<p>A√ß√£o de mitiga√ß√£o imediata:</p>
<p><img src="Img/Matando_processo_malicioso.png" alt="Matando Processo"></p>
<p><strong>A√ß√£o:</strong> Termina√ß√£o segura do processo malicioso.</p>
<h4 id="fase-11-preserva%C3%A7%C3%A3o-de-evid%C3%AAncias"><strong>FASE 11: Preserva√ß√£o de Evid√™ncias</strong></h4>
<p>Cria√ß√£o de imagem forense para an√°lise posterior:</p>
<p><img src="Img/Configuracao_ferramenta_disk2vhd.png" alt="Configura√ß√£o Disk2VHD"></p>
<p><img src="Img/envio_de_copia_FS_VHDX.png" alt="C√≥pia VHDX"></p>
<p><strong>A√ß√£o:</strong> Preserva√ß√£o completa do estado do sistema para an√°lise forense posterior.</p>
<h3 id="72-t%C3%A9cnicas-t%C3%A1ticas-e-procedimentos-ttps-identificados">7.2 T√©cnicas, T√°ticas e Procedimentos (TTPs) Identificados</h3>
<h4 id="t%C3%A9cnicas-de-evas%C3%A3o"><strong>T√©cnicas de Evas√£o:</strong></h4>
<ol>
<li>
<p><strong>T1564.001 - Hidden Files and Directories</strong></p>
<ul>
<li>Uso de nomes de processos leg√≠timos (OneDrive.exe, svchost.exe)</li>
<li>Instala√ß√£o em diret√≥rios n√£o padr√£o</li>
</ul>
</li>
<li>
<p><strong>T1036 - Masquerading</strong></p>
<ul>
<li>Mascaramento como processos do Windows</li>
<li>Uso de nomes de tarefas leg√≠timas (Windows Update, Sqm-Update)</li>
</ul>
</li>
</ol>
<h4 id="t%C3%A9cnicas-de-persist%C3%AAncia"><strong>T√©cnicas de Persist√™ncia:</strong></h4>
<ol>
<li>
<p><strong>T1547.001 - Registry Run Keys</strong></p>
<ul>
<li>HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</li>
<li>HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Update</li>
</ul>
</li>
<li>
<p><strong>T1053.005 - Scheduled Tasks</strong></p>
<ul>
<li>\Microsoft\Windows\Sqm-Update</li>
<li>\Microsoft\Windows\Windows Update</li>
</ul>
</li>
<li>
<p><strong>T1547.005 - Startup Items</strong></p>
<ul>
<li>Pasta de inicializa√ß√£o do usu√°rio</li>
<li>Execu√ß√£o autom√°tica no login</li>
</ul>
</li>
</ol>
<h4 id="t%C3%A9cnicas-de-execu%C3%A7%C3%A3o"><strong>T√©cnicas de Execu√ß√£o:</strong></h4>
<ol>
<li><strong>T1204.002 - User Execution: Malicious File</strong>
<ul>
<li>Execu√ß√£o de arquivos n√£o assinados</li>
<li>M√∫ltiplas c√≥pias para redund√¢ncia</li>
</ul>
</li>
</ol>
<hr>
<h2 id="8-an%C3%A1lise-t%C3%A9cnica-detalhada">8. AN√ÅLISE T√âCNICA DETALHADA</h2>
<h3 id="81-vulnerabilidades-do-sistema-identificadas">8.1 Vulnerabilidades do Sistema Identificadas</h3>
<ol>
<li><strong>Sistema Desatualizado:</strong> √öltima atualiza√ß√£o em fevereiro de 2023 (mais de 2 anos)</li>
<li><strong>Aus√™ncia de Antiv√≠rus:</strong> Nenhuma prote√ß√£o ativa detectada</li>
<li><strong>Disco Cheio:</strong> Volume C: com 0.00 GB livre - poss√≠vel causa de falhas de sistema</li>
<li><strong>Ambiente Virtualizado:</strong> QEMU pode apresentar vulnerabilidades espec√≠ficas</li>
</ol>
<h3 id="82-vectors-de-ataque-identificados">8.2 Vectors de Ataque Identificados</h3>
<ol>
<li><strong>Execu√ß√£o Inicial:</strong> M√©todo n√£o identificado (poss√≠vel phishing, exploit ou acesso f√≠sico)</li>
<li><strong>Propaga√ß√£o:</strong> C√≥pia para m√∫ltiplas localiza√ß√µes estrat√©gicas</li>
<li><strong>Persist√™ncia Multi-Vetor:</strong> 4 mecanismos diferentes de reinicializa√ß√£o</li>
<li><strong>Mascaramento Avan√ßado:</strong> Uso de nomes leg√≠timos do Windows</li>
</ol>
<h3 id="83-impacto-potencial">8.3 Impacto Potencial</h3>
<ul>
<li><strong>Criptografia de Arquivos:</strong> Capacidade de ransomware confirmada</li>
<li><strong>Persist√™ncia Garantida:</strong> M√∫ltiplos mecanismos de reinicializa√ß√£o</li>
<li><strong>Privil√©gios Elevados:</strong> Execu√ß√£o como Administrator</li>
<li><strong>Evas√£o de Detec√ß√£o:</strong> T√©cnicas avan√ßadas de mascaramento</li>
<li><strong>Redund√¢ncia:</strong> M√∫ltiplas c√≥pias para garantir sobreviv√™ncia</li>
</ul>
<hr>
<h2 id="9-a%C3%A7%C3%B5es-de-mitiga%C3%A7%C3%A3o-realizadas">9. A√á√ïES DE MITIGA√á√ÉO REALIZADAS</h2>
<h3 id="91-isolamento">9.1 Isolamento</h3>
<ul>
<li>‚úÖ Desconex√£o da rede principal</li>
<li>‚úÖ Cria√ß√£o de ambiente isolado para an√°lise</li>
<li>‚úÖ Uso de VM com rede NAT</li>
<li>‚úÖ Conex√£o VPN segura com auditoria (Controle 270920250907)</li>
</ul>
<h3 id="92-identifica%C3%A7%C3%A3o">9.2 Identifica√ß√£o</h3>
<ul>
<li>‚úÖ An√°lise com Autoruns64.exe</li>
<li>‚úÖ Verifica√ß√£o de hashes no VirusTotal</li>
<li>‚úÖ Compara√ß√£o com arquivos leg√≠timos</li>
<li>‚úÖ Identifica√ß√£o de mecanismos de persist√™ncia</li>
<li>‚úÖ Script customizado de invent√°rio completo</li>
</ul>
<h3 id="93-preserva%C3%A7%C3%A3o-de-evid%C3%AAncias">9.3 Preserva√ß√£o de Evid√™ncias</h3>
<ul>
<li>‚úÖ Cria√ß√£o de imagem forense com Disk2VHD</li>
<li>‚úÖ Documenta√ß√£o fotogr√°fica completa (14 imagens)</li>
<li>‚úÖ Logs de todas as a√ß√µes realizadas</li>
<li>‚úÖ Backup criptografado das evid√™ncias (f√≠sico + nuvem)</li>
</ul>
<h3 id="94-remo%C3%A7%C3%A3o-de-artefatos-maliciosos">9.4 Remo√ß√£o de Artefatos Maliciosos</h3>
<ul>
<li>‚úÖ Identifica√ß√£o de todos os arquivos maliciosos (3 localiza√ß√µes)</li>
<li>‚úÖ Mapeamento de mecanismos de persist√™ncia (4 vetores)</li>
<li>‚úÖ Termina√ß√£o de processos maliciosos</li>
<li>‚úÖ Prepara√ß√£o para limpeza completa</li>
</ul>
<hr>
<h2 id="10-recomenda%C3%A7%C3%B5es-t%C3%A9cnicas">10. RECOMENDA√á√ïES T√âCNICAS</h2>
<h3 id="101-a%C3%A7%C3%B5es-imediatas-cr%C3%ADticas">10.1 A√ß√µes Imediatas (Cr√≠ticas)</h3>
<ol>
<li>
<p><strong>Remo√ß√£o Completa de Artefatos:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Remover arquivos maliciosos</span>
<span class="hljs-built_in">Remove-Item</span> <span class="hljs-string">"C:\Users\Administrator\AppData\Roaming\OneDrive.exe"</span> <span class="hljs-literal">-Force</span>
<span class="hljs-built_in">Remove-Item</span> <span class="hljs-string">"C:\Windows\Temp\OneDrive.exe"</span> <span class="hljs-literal">-Force</span>
<span class="hljs-built_in">Remove-Item</span> <span class="hljs-string">"C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe"</span> <span class="hljs-literal">-Force</span>

<span class="hljs-comment"># Limpar Registry</span>
<span class="hljs-built_in">Remove-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">"HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">"Windows Update"</span>
<span class="hljs-built_in">Remove-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">"HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager"</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">"Update"</span>

<span class="hljs-comment"># Remover tarefas agendadas</span>
schtasks /Delete /TN <span class="hljs-string">"\Microsoft\Windows\Sqm-Update"</span> /F
schtasks /Delete /TN <span class="hljs-string">"\Microsoft\Windows\Windows Update"</span> /F
</div></code></pre>
</li>
<li>
<p><strong>Verifica√ß√£o de Integridade do Sistema:</strong></p>
<ul>
<li>Executar <code>sfc /scannow</code></li>
<li>Verificar assinaturas digitais de todos os execut√°veis cr√≠ticos</li>
<li>Comparar hashes de arquivos do sistema</li>
</ul>
</li>
</ol>
<h3 id="102-a%C3%A7%C3%B5es-de-curto-prazo">10.2 A√ß√µes de Curto Prazo</h3>
<ol>
<li>
<p><strong>Implementa√ß√£o de Monitoramento:</strong></p>
<ul>
<li>Deploy de EDR/XDR</li>
<li>Monitoramento de processos n√£o assinados</li>
<li>Alertas para modifica√ß√µes no Registry</li>
</ul>
</li>
<li>
<p><strong>Hardening do Sistema:</strong></p>
<ul>
<li>Desabilitar execu√ß√£o de scripts PowerShell n√£o assinados</li>
<li>Implementar AppLocker ou Software Restriction Policies</li>
<li>Configurar audit logs detalhados</li>
</ul>
</li>
</ol>
<h3 id="103-a%C3%A7%C3%B5es-de-longo-prazo">10.3 A√ß√µes de Longo Prazo</h3>
<ol>
<li>
<p><strong>Seguran√ßa Defensiva:</strong></p>
<ul>
<li>Implementa√ß√£o de backup offline</li>
<li>Teste regular de procedimentos de recupera√ß√£o</li>
<li>Treinamento de usu√°rios em seguran√ßa</li>
</ul>
</li>
<li>
<p><strong>Monitoramento Cont√≠nuo:</strong></p>
<ul>
<li>An√°lise regular de logs</li>
<li>Verifica√ß√£o peri√≥dica de integridade</li>
<li>Atualiza√ß√µes de seguran√ßa autom√°ticas</li>
</ul>
</li>
</ol>
<hr>
<h2 id="11-indicadores-de-compromisso-iocs">11. INDICADORES DE COMPROMISSO (IOCs)</h2>
<h3 id="111-file-hashes">11.1 File Hashes</h3>
<pre class="hljs"><code><div>MD5: 77C59720BC328CF9D692A215AA2575AD
SHA1: EF1A74599739AB0F91D9CE44C4F4A86B24563E4F
SHA256: 1CB281692409B000C6BFD17C737CE96EC98DEC9A5D420EEB6E5B0C131FC2BD5F
</div></code></pre>
<h3 id="112-file-paths">11.2 File Paths</h3>
<pre class="hljs"><code><div>C:\Users\Administrator\AppData\Roaming\OneDrive.exe
C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.exe
C:\Windows\Temp\OneDrive.exe
</div></code></pre>
<h3 id="113-registry-keys">11.3 Registry Keys</h3>
<pre class="hljs"><code><div>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows Update
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Update
</div></code></pre>
<h3 id="114-scheduled-tasks">11.4 Scheduled Tasks</h3>
<pre class="hljs"><code><div>\Microsoft\Windows\Sqm-Update
\Microsoft\Windows\Windows Update
</div></code></pre>
<hr>
<h2 id="12-li%C3%A7%C3%B5es-aprendidas">12. LI√á√ïES APRENDIDAS</h2>
<h3 id="121-pontos-positivos">12.1 Pontos Positivos</h3>
<ul>
<li>‚úÖ Isolamento eficaz do sistema comprometido</li>
<li>‚úÖ Uso de ferramentas forenses adequadas</li>
<li>‚úÖ Documenta√ß√£o completa do incidente</li>
<li>‚úÖ Preserva√ß√£o adequada de evid√™ncias</li>
</ul>
<h3 id="122-%C3%A1reas-de-melhoria">12.2 √Åreas de Melhoria</h3>
<ul>
<li>‚ö†Ô∏è Necessidade de detec√ß√£o mais precoce</li>
<li>‚ö†Ô∏è Implementa√ß√£o de monitoramento proativo</li>
<li>‚ö†Ô∏è Backup e procedimentos de recupera√ß√£o</li>
<li>‚ö†Ô∏è Treinamento de usu√°rios</li>
</ul>
<hr>
<h2 id="13-conclus%C3%B5es">13. CONCLUS√ïES</h2>
<p>O incidente investigado revela um ataque de ransomware sofisticado com m√∫ltiplos vetores de persist√™ncia e t√©cnicas avan√ßadas de evas√£o. O malware Ransomware.Python/NCSLM foi identificado e completamente mapeado, permitindo a remo√ß√£o segura de todos os artefatos maliciosos.</p>
<h3 id="principais-descobertas">Principais Descobertas:</h3>
<ol>
<li><strong>M√∫ltiplas Persist√™ncias:</strong> 4 mecanismos diferentes de reinicializa√ß√£o</li>
<li><strong>Evas√£o Avan√ßada:</strong> Mascaramento atrav√©s de nomes leg√≠timos</li>
<li><strong>Privil√©gios Elevados:</strong> Execu√ß√£o com direitos de Administrator</li>
<li><strong>Impacto Contido:</strong> Sistema isolado antes da propaga√ß√£o</li>
</ol>
<h3 id="status-da-investiga%C3%A7%C3%A3o">Status da Investiga√ß√£o:</h3>
<ul>
<li>‚úÖ <strong>Identifica√ß√£o:</strong> Completa</li>
<li>‚úÖ <strong>Mapeamento:</strong> Completo</li>
<li>‚úÖ <strong>Mitiga√ß√£o:</strong> Iniciada</li>
<li>‚è≥ <strong>Recupera√ß√£o:</strong> Em andamento</li>
</ul>
<hr>
<h2 id="14-anexos">14. ANEXOS</h2>
<h3 id="141-evid%C3%AAncias-fotogr%C3%A1ficas">14.1 Evid√™ncias Fotogr√°ficas</h3>
<ul>
<li>Todas as imagens est√£o dispon√≠veis na pasta <code>Img/</code></li>
<li>N√∫meros de controle para auditoria: 270920250907</li>
</ul>
<h3 id="142-logs-t%C3%A9cnicos">14.2 Logs T√©cnicos</h3>
<ul>
<li>Invent√°rio completo do sistema</li>
<li>Logs de ferramentas forenses</li>
<li>Transcri√ß√µes de comandos executados</li>
</ul>
<h3 id="143-metadados-do-caso">14.3 Metadados do Caso</h3>
<ul>
<li><strong>ID do Caso:</strong> INC-FS-2025-001</li>
<li><strong>Analista Respons√°vel:</strong> Jackson Antonio Zacarias Savoldi</li>
<li><strong>Laborat√≥rio:</strong> SOC_AL3RT</li>
<li><strong>Data de In√≠cio:</strong> 27/09/2025 11:53:31</li>
<li><strong>Data de Conclus√£o:</strong> 27/09/2025</li>
<li><strong>Tempo Total de Investiga√ß√£o:</strong> [A calcular]</li>
</ul>
<hr>
<p><strong>RELAT√ìRIO ELABORADO POR:</strong><br>
Jackson Antonio Zacarias Savoldi<br>
Analista de Seguran√ßa Cibern√©tica<br>
Especializa√ß√£o em Seguran√ßa da Informa√ß√£o<br>
LinkedIn: linkedin.com/in/jacksonzacarias<br>
Instagram: @jacksonsavoldi<br>
<strong>Laborat√≥rio:</strong> SOC_AL3RT</p>
<p><strong>APROVA√á√ÉO:</strong><br>
[Assinatura do Supervisor]<br>
[Data de Aprova√ß√£o]</p>
<hr>
<p><strong>DOCUMENTO CONFIDENCIAL - DISTRIBUI√á√ÉO RESTRITA</strong><br>
Este documento cont√©m informa√ß√µes sens√≠veis sobre incidentes de seguran√ßa e deve ser tratado como confidencial conforme as pol√≠ticas organizacionais.</p>

</body>
</html>
